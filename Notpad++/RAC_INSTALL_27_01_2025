enp0s3 --Internet
enp0s8--pub
enp0s9--priv

yum install -y oracle* --skip-broken
yum install -y oracle-database-preinstall-19c
yum install -y oracleasm-support

CONFIGURE KERNEL PARAMETERS & CONFIGURE LIMITS.CONF FILE AS PER RAC INSTALLATION GUIDE 

vi /etc/sysctl.conf

fs.aio-max-nr = 1048576
fs.file-max = 6815744
kernel.shmall = 2097152
kernel.shmmax = 4294967295
kernel.shmmni = 4096
kernel.sem = 250 32000 100 128
net.ipv4.ip_local_port_range = 9000 65500
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576

sysctl -p



vi /etc/security/limits.conf

grid soft nproc 2047
grid hard nproc 16384
grid soft nofile 1024
grid hard nofile 65536
oracle soft nproc 2047
oracle hard nproc 16384
oracle soft nofile 1024
oracle hard nofile 65536
oracle soft stack 32768


Group Creation:

groupadd -g 5001 oinstall
groupadd -g 5002 dba
groupadd -g 5003 oper
groupadd -g 5004 asmadmin 
groupadd -g 5005 asmdba
groupadd -g 5006 asmoper


User Creation:

useradd -u 5007 -g oinstall -G dba,oper,asmdba oracle
useradd -u 5008 -g oinstall -G asmadmin,asmdba,asmoper,dba grid

usermod -g oinstall -G dba,oper,asmdba oracle
usermod -g oinstall -G asmadmin,asmdba,asmoper,dba grid

passwd oracle
passwd grid

sudo cat /etc/security/limits.conf


Create the directories in which the Oracle / Grid software will be installed.

mkdir -p /u01/app/grid
mkdir -p /u01/app/19c/gridhome_1
mkdir -p /u02/app/oracle
mkdir -p /u02/app/oracle/product/19c/dbhome_1
mkdir -p /u01/app/oraInventory
mkdir -p /u01/LATEST_PATCH/
chown -R grid:oinstall /u01
chown -R oracle:oinstall /u02
chown -R grid:oinstall /u01/app/oraInventory
chmod -R 775 /u01
chmod -R 775 /u02



Set bash_profile for grid and oracle user login to grid user and set .bash_profile :

nano .bash_profile

export GRID_BASE=/u01/app/grid
export GRID_HOME=/u01/app/19c/gridhome_1
export ORACLE_BASE=/u02/app/oracle
export ORACLE_HOME=/u02/app/oracle/product/19c/dbhome_1
export ORACLE_SID=prodl
export BASE_PATH=/usr/sbin:$PATH
export PATH=$ORACLE_HOME/bin:$BASE PATH
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib
export CLASSPATH=$ORACLE_HOME/JRE:$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib
export PATH=/bin:/usr/bin:/usr/sbin:$PATH


. .bash_profile

login to oracle user and set .bash_profile :

export TMP=/tmp
export TMPDIR=$TMP
export ORACLE_BASE=/u02/app/oracle
export ORACLE_HOME=/u02/app/oracle/product/19c/dbhome_1
export ORACLE_SID=prodl
export ORACLE TERM=xterm
export BASE_PATH=/usr/sbin:$PATH
export PATH=$ORACLE_HOME/bin:$BASE PATH
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib
export CLASSPATH=$ORACLE_HOME/JRE:$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib
export PATH=/bin:/usr/bin:/usr/sbin:$PATH

. .bash_profile

Add the following entry in /etc/hosts file and crosscheck node rea Primary Site:

Add the following entry in /etc/hosts file and crosscheck node reachability Primary Site:


# Public
192.168.1.132   db1.db.com db1
192.168.1.133    db2.db.com db2
# Private
192.168.0.142  db1-priv.db.com db1-priv
192.168.0.143 db2-priv.db.com db2-priv
# Virtual
192.168.1.152  db1-vip.db.com db1-vip
192.168.1.153 db2-vip.db.com db2-vip
# SCAN
192.168.1.162 db-scan.db.com db-scan
192.168.1.163 db-scan.db.com db-scan
192.168.1.164  db-scan.db.com db-scan





Firewall Stop and Disable
We can open firewall after installation

systemctl stop   firewalld
systemctl disable firewalld


To Make Node1 as a DNS Server do below step - On Node1 and Node2
	
ps -ef |grep dnsmasq
kill -9 <PID>

service dnsmasq status
service dnsmasq start
service dnsmasq status

systemctl is-enabled dnsmasq
systemctl enable dnsmasq
systemctl is-enabled dnsmasq

Add the DNS Server Details on Each Node

From Node1/Node2 - Initial it will NOT work

nslookup db-scan

In the below file Add DNS Server IP - in our case Node1 server Public IP is the DNS Server IP  - 192.168.1.132


On - Node1 - rac1 and Node2 -rac2
------------------------
nano /etc/sysconfig/network-scripts/ifcfg-enp0s8

##Go to end of the file Add below line on this file keep other lines as it is
DNS1=192.168.1.132

#if not resolve DNS error TRY BLOW CMD
sudo firewall-cmd --list-all
sudo firewall-cmd --zone=public --add-port=53/tcp --add-port=53/udp --permanent
sudo firewall-cmd --reload



[root@ambasanode1 ~]# cat /etc/resolv.conf
# Generated by NetworkManager
nameserver 192.168.1.132

#if ip is not ther in resolv.conf file then change our ip 
 nano /etc/resolv.conf
nameserver 192.168.1.132

nano /etc/dnsmasq.conf
listen-address=192.168.1.132
server=192.168.1.1
domain=db.com
log-queries
address=/db.com/192.168.1.132

sudo systemctl restart dnsmasq
nslookup db.com


ON ALL NODES
nmcli device status
nmcli con show
nmcli con reload
systemctl restart NetworkManager


Disable or delete virbr0 interface
virsh net-destroy default
virsh net-autostart default --disable
virsh net-undefine default
chkconfig libvirtd off



===>disk partion<<====================================


Create shared ASM Disk FOR OCR, DATAFILE and ARCHIVE on Both Sites
Add new shared disk to virtual box machines it should be sharable

Login to system and run 
ls /dev/sd*

fdisk -l | grep /dev/sd

printf "o\nn\np\n1\n\n\nw\n" | sudo fdisk /dev/sdb

printf "o\nn\np\n1\n\n\nw\n" | sudo fdisk /dev/sdc

printf "o\nn\np\n1\n\n\nw\n" | sudo fdisk /dev/sdd


init 6



Set ASM disks >>>> oracleasm configure -i   
                                owner:grid
		                         group:oinstall
		                         
intial >>>>>>      oracleasm init
Create ASM disks >>>> oracleasm createdisk ASM_OCR  /dev/sdd1
                     oracleasm createdisk ASM_DATA /dev/sdb1
                     oracleasm createdisk ASM_RECO /dev/sdc1
					 
Scan ASM disks >>>> oracleasm scandisks
                    oracleasm listdisks

cd /dev/oracleasm/disks

##########################################################

UNZIP GRID FILE >> IN Grid_HOME
UNZIP ORACLE_HOME>> IN ORACLE_HOME

######### On Primary Site ##################################

Copy software to nodel on primary site and unzip software at grid home location and rdbms home locations by login to respective users Setup passwordless ssh configuration

cd /u01/app/19c/gridhome_1/deinstall

./sshUserSetup.sh -user grid -hosts "db1 db2" -noPrompt Passphrase -confirm -advanced

Similarly do it for oracle user

cd /u02/app/oracle/product/19c/dbhome_1/deinstall

./sshUserSetup.sh user oracle -hosts "db1 db2" -noPromptPassphrase confirm -advanced

./sshUserSetup.sh user root -hosts "db1 db2" -noPromptPassphrase confirm -advanced

Set profile and go to ORACLE_HOME location from grid user and run following command and follow the steps.


cd /u01/app/19c/gridhome_1/cv/rpm
scp cvuqdisk-1.0.10-1.rpm root@db2:/tmp
rpm -i cvuqdisk-1.0.10-1.rpm

#precheck
./runcluvfy.sh stage -pre crsinst -fixupnoexec -n db1

cd $ORACLE HOME

./gridSetup.sh -applyRU /u01/LATEST_PATCH/32$45008

#RUN root.sh scrept on db1 and db2

Once Grid Installation done, Install RDBMS Software through oracle user and create RAC database prod (check our previous video's for more detail)

 ./runInstaller -applyRU /u01/LATEST PATCH/32545008
 
Use DBCA to create database prod


####Primary Site Step 1: ################################

Enable Forced Logging on Primary:

select name, open_mode, cdb from v$database;

select force_logging from v$database;
ALTER DATABASE FORCE LOGGING; >>>>> change using this command 
select force_logging from v$database; >>>>> Verify changes


##INSTALL GRID USING RESPONCEE FILE
[oracle@rac1 ~]$ cp /u01/app/19.0.0/grid/install/response/gridsetup.rsp .
[oracle@rac1 ~]$ vi gridsetup.rsp


[oracle@rac1 ~]$ grep "=" gridsetup.rsp | grep -v "^#" | grep -v "=$"
oracle.install.responseFileVersion=/oracle/install/rspfmt_crsinstall_response_schema_v19.0.0

INVENTORY_LOCATION=/u02/app/oraInventory
oracle.install.option=CRS_CONFIG
ORACLE_BASE=/u02/app/oracle
oracle.install.asm.OSDBA=dba
oracle.install.asm.OSOPER=dba
oracle.install.asm.OSASM=dba
oracle.install.crs.config.scanType=LOCAL_SCAN
oracle.install.crs.config.gpnp.scanName=db-scan
oracle.install.crs.config.gpnp.scanPort=1521
oracle.install.crs.config.ClusterConfiguration=STANDALONE
oracle.install.crs.config.clusterName=rac
oracle.install.crs.config.clusterNodes=db1:db1-vip,db2:db2-vip
oracle.install.crs.config.networkInterfaceList=enp0s8:192.168.1.0:1,enp0s9:192.168.0.0:2
oracle.install.crs.configureGIMR=false
oracle.install.crs.config.storageOption=FLEX_ASM_STORAGE
oracle.install.asm.SYSASMPassword=Oracle123
oracle.install.asm.diskGroup.name=DATA
oracle.install.asm.diskGroup.redundancy=EXTERNAL
oracle.install.asm.diskGroup.AUSize=4
oracle.install.asm.diskGroup.disks=/dev/oracleasm/disks/ASM_DATA,/dev/oracleasm/disks/ASM_OCR,/dev/oracleasm/disks/ASM_RECO
oracle.install.asm.diskGroup.diskDiscoveryString=/dev/oracleasm/disks/*
oracle.install.asm.monitorPassword=Oracle123
oracle.install.asm.configureAFD=false



oracle@rac1 ~]$ /u01/app/19c/gridhome_1/gridSetup.sh -silent -responseFile /u01/app/19c/gridhome_1/install/response/gridsetup.rsp -ignorePrereqFailure
Launching Oracle Grid Infrastructure Setup Wizard...
 





[root@db1 GridSetupActions2025-01-31_12-05-02PM]# echo $DISPLAY

[root@db1 ~]# export DISPLAY=:0
[root@db1 ~]# echo $DISPLAY
:0
[root@db1 ~]# xhost +SI:localuser:oracle
localuser:oracle being added to access control list


echo $DISPLAY
export DISPLAY=:0
export DBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-oEA2H9Dc5c,guid=4ab09dde0525787abf115ac3679c697c
[root@db1 ~]# xhost +SI:localuser:grid
xhost +SI:localuser:oracle
localuser:grid being added to access control list

--------------------------------------------------
#delete oracleasm disks

oracleasm deletedisk ASM_DATA
oracleasm deletedisk ASM_OCR
oracleasm deletedisk ASM_RECO



oracleasm scandisks
oracleasm listdisks


